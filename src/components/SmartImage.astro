---
const { src, alt = "", class: className, position = "center" } = Astro.props;

const isLocal = src.startsWith("./") || src.startsWith("../");

const imageClass = "w-full h-full object-cover";
const imageStyle = `object-position: ${position}`;

const cdn1 = src.startsWith("http") ? src : `https://gcore.jsdelivr.net/gh/chemmasterynahida/chemmasterynahida-assets/${src}`;
const cdn2 = src.startsWith("http") ? src : `https://cdn.jsdelivr.net/gh/chemmasterynahida/chemmasterynahida-assets/${src}`;
const cdn3 = `/assets/${src}`;
---

{isLocal ? (
  <img src={src} alt={alt} class={imageClass} style={imageStyle} />
) : (
  <img
    src={cdn1}
    alt={alt}
    class={imageClass}
    style={imageStyle}
    loading="lazy"
    decoding="async"
    data-step="1"
    onerror={`if(this.dataset.step==='1'){this.dataset.step='2';this.src='${cdn2}';}
              else if(this.dataset.step==='2'){this.dataset.step='3';this.src='${cdn3}';}`}
  />
)}